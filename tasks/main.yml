# SPDX-License-Identifier: MIT-0
---
# tasks file for windows-base
- name: Gather Windows facts
  ansible.builtin.setup:
  become: false

# Chocolatey setup removed as per policy
# - name: Setup Chocolatey
#   ansible.builtin.include_tasks: choco.yml
#   when:
#     - ansible_facts['os_family'] == 'Windows'
#     - choco_enabled | default(false)
#   tags:
#     - choco
#     - chocolatey

- name: Configure security
  ansible.builtin.include_tasks: security.yml
  when:
    - ansible_facts['os_family'] == 'Windows'
    - security_enabled | default(true)
  tags:
    - security

- name: Install agents
  ansible.builtin.include_tasks: agents.yml
  when: ansible_facts['os_family'] == 'Windows'
  tags:
    - agents

- name: Configure WSManCredSSP
  ansible.builtin.include_tasks: credssp.yml
  when:
    - ansible_facts['os_family'] == 'Windows'
    - credssp_enabled | default(true)
  tags:
    - credssp
